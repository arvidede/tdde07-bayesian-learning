lines(range, mx, lwd=3, type='l', col='red', xlab = 'sigma')
cred_int <- quantile(G, probs = c(a, b))
plot(density(G),
col='blue',
xlim=c(0,1),
ylim=c(0,9),
main="95% credibility interval")
abline(v=cred_int[1], col='red')
abline(v=cred_int[2], col='red')
G_dens = density(G)
View(G_dens)
View(G_dens)
sumY <- sum(G_dens.y)
sumY <- sum(G_dens.Y)
sumY <- sum(G_dens[y])
sumY <- sum(G_dens['y'])
sumY <- sum(G_dens[,y])
sumY <- sum(G_dens[,'y'])
sumY <- sum(G_dens["y",])
sumY <- sum(G_dens["y"])
sumY <- (G_dens["y"])
View(sumY)
sumY <- Reduce("+", G_dens["y"])
sumY <- Reduce("+", G_dens["y"])
sumY <- Reduce("+", G_dens["y",])
sumY <- Reduce("+", G_dens["y"])
View(G_dens)
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
View(G.dens)
View(G_dens)
?density
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
View(yVals)
sum <- sum(G_dens$y)
y_ordered = G_dens$y[order(-G_dens$y)]
y_ordered = G_dens$y[order(+G_dens$y)]
G_dens = density(G)
y_ordered = G_dens$y[order(-G_dens$y)]
x_ordered = G_dens$x[order(-G_dens$x)]
dens_mass = sum(G_dens$y)
sum <- 0
for (i in y_ordered) {
current_mass <- y_ordered[i] + sum
if ((current_mass/dens_mass) > 0.95) {
break
} else {
sum <- current_mass
}
}
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
cred_int <- quantile(G, probs = c(a, b))
plot(density(G),
col='blue',
xlim=c(0,1),
ylim=c(0,9),
main="95% credibility interval")
abline(v=cred_int[1], col='red')
abline(v=cred_int[2], col='red')
abline(v=a, col='green')
abline(v=b, col='green')
a <- 0.025
b <- 0.975
cred_int <- quantile(G, probs = c(a, b))
G_dens = density(G)
y_ordered = G_dens$y[order(-G_dens$y)]
x_ordered = G_dens$x[order(-G_dens$y)]
dens_mass = sum(G_dens$y)
sum <- 0
for (i in y_ordered) {
current_mass <- y_ordered[i] + sum
if ((current_mass/dens_mass) > 0.95) {
break
} else {
sum <- current_mass
}
}
a <- min(x_ordered[1:i])
b <- max(x_ordered[1:i])
plot(density(G),
col='blue',
xlim=c(0,1),
ylim=c(0,9),
main="95% credibility interval")
abline(v=cred_int[1], col='red')
abline(v=cred_int[2], col='red')
abline(v=a, col='green')
abline(v=b, col='green')
a <- min(x_ordered[1:i])
b <- max(x_ordered[1:i])
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_2.R')
cred_int <- quantile(G, probs = c(0.025, 0.975))
G_dens = density(G)
y_ordered = G_dens$y[order(-G_dens$y)]
x_ordered = G_dens$x[order(-G_dens$y)]
dens_mass = sum(G_dens$y)
sum <- 0
for (i in y_ordered) {
current_mass <- y_ordered[i] + sum
if ((current_mass/dens_mass) > 0.95) {
break
} else {
sum <- current_mass
}
}
a <- min(x_ordered[1:i])
b <- max(x_ordered[1:i])
plot(density(G),
col='blue',
xlim=c(0,1),
ylim=c(0,9),
main="95% credibility interval")
abline(v=cred_int[1], col='red')
abline(v=cred_int[2], col='red')
abline(v=a, col='green')
abline(v=b, col='green')
cred_int <- quantile(G, probs = c(0.025, 0.975))
G_dens = density(G)
y_ordered = G_dens$y[order(-G_dens$y)]
x_ordered = G_dens$x[order(-G_dens$y)]
dens_mass = sum(G_dens$y)
sum <- 0
current_mass <- 0
for (i in y_ordered) {
current_mass <- y_ordered[i] + sum
if ((current_mass/dens_mass) > 0.95) {
break
} else {
sum <- current_mass
}
}
a <- min(x_ordered[1:i])
b <- max(x_ordered[1:i])
plot(density(G),
col='blue',
xlim=c(0,1),
ylim=c(0,9),
main="95% credibility interval")
abline(v=cred_int[1], col='red')
abline(v=cred_int[2], col='red')
abline(v=a, col='green')
abline(v=b, col='green')
cred_int <- quantile(G, probs = c(0.025, 0.975))
G_dens = density(G)
y_ordered = G_dens$y[order(-G_dens$y)]
x_ordered = G_dens$x[order(-G_dens$y)]
dens_mass = sum(G_dens$y)
sum <- 0
current_mass <- 0
for (i in 1:length(y_ordered)) {
current_mass <- y_ordered[i] + sum
if ((current_mass/dens_mass) > 0.95) {
break
} else {
sum <- current_mass
}
}
a <- min(x_ordered[1:i])
b <- max(x_ordered[1:i])
plot(density(G),
col='blue',
xlim=c(0,1),
ylim=c(0,9),
main="95% credibility interval")
abline(v=cred_int[1], col='red')
abline(v=cred_int[2], col='red')
abline(v=a, col='green')
abline(v=b, col='green')
k <- dexp(1)
plot(k)
k <- dexp(y,1)
plot(k)
?dexp
n = seq(0, 10, by=0.01)
k <- dexp(n,1)
plot(k)
plot(k, type='l')
?bessel
?pi
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_3.R')
clear
?clear
k <- length(kappa)
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab1/lab1_3.R')
?dexp
kappa <- dexp(1)
kappa <- dexp(2)
kappa <- dexp(x,lambda)
k <- length(kappa)
y <- c(-2.44, 2.14, 2.54, 1.83, 2.01, 2.33, -2.79, 2.23, 2.07, 2.02)
x <- seq(0,10, by=0.01)
mu <- 2.39
lambda <- 1
kappa <- dexp(x,lambda)
k <- length(kappa)
plot(k, kappa, type = 'l')
plot(x, kappa, type = 'l')
?sapply
likelihood = likelihood*Mises(kappa, y, mu)
likelihood = Mises(kappa, y, mu)
likelihood = Mises(kappa, y, mu)
Mises <- function(kappa, y, mu) {
I <- besselI(kappa,0)
return (exp(kappa*cos(y-mu)))/(2*pi*I)
}
likelihood = Mises(kappa, y, mu)
likelihood = Mises(kappa[1], y, mu)
install.packages(knitr)
install.packages('knitr')
install.packages("knitr")
install.packages("rmarkndown")
install.packages("markndown")
install.packages(“devtools”)
install.packages('devtools')
?gln
?glm
setwd("~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3")
data = read.table("rainfall.dat")
data = read.table("rainfall.txt")
data = read.table("rainfall.txt")
data
plot(data)
data = read.table("rainfall.txt")
########### A ###########
# parameter init values
mu0 <- 0
tau0 <- 0
v0 <- 0
n <- length(data)
dataMean <- mean(data)
drawMu <- function(prevMu, prevTau, prevSigma) {
tauSq <- 1/( (n/prevSigma) + (1/prevTau^2) )
w <- (n/prevSigma)/((n/prevSigma) + (1/prevTau^2))
mu <- w*dataMean + (1-w)*mu0
draw <- rnorm(1, mu, tauSq)
return (draw)
}
?mean
data = as.vector(read.table("rainfall.txt"))
data[1,]
data[,1]
n <- length(data[,1])
data
length(data)
length(data[,2])
length(data[,1])
n <- nrow(data)
n
data
data
data[[1]]
data
dataMean <- mean(data[[1]])
data = read("rainfall.txt")
data = read.table("rainfall.txt", col.names = "x")
data
View(data)
dataMean <- mean(data$x)
data = read.table("rainfall.txt", col.names = "x")
########### A ###########
# parameter init values
mu0 <- 0
tau0 <- 0
v0 <- 0
n <- nrow(data)
dataMean <- mean(data$x)
vn <- v0 + n
iter <- 1000
# draw mu
drawMu <- function(prevMu, prevSigma) {
tauSq <- 1/( (n/prevSigma) + (1/tau0^2) )
w <- (n/prevSigma)/((n/prevSigma) + (1/tau0^2))
mu <- w*dataMean + (1-w)*mu0
draw <- rnorm(1, mu, tauSq)
return (draw)
}
#inv chi square
invChiSquare <- function(v, s) {
return(v*s / rchisq(1,v))
}
# draw sigma
drawSigma <- function(mu) {
sum <- 0
for (i in 1:n) {
sum <- sum + (data$x[i] - mu)^2
}
s <- (v0 + sum)/(n+v0)
return(invChiSquare(vn, s))
}
mu <- c()
sigma2 <- c()
prevMu <- 0
prevSigma <- 0
for (i in 1:iter) {
currMu <- drawMu(prevMu, prevSigma)
currSigma <- drawSigma(currMu)
mu <- c(mu, currMu)
sigma2 <- c(sigma2, currSigma)
}
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
View(data)
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
data$x[1]
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
?rnorm
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
summary(sigma2)
s <- (v0*sigma0 + sum)/(n+v0)
currSigma <- drawSigma(currMu)
drawSigma <- function(mu) {
sum <- 0
for (i in 1:n) {
sum <- sum + (data[i,1] - mu)^2
}
s <- (v0*sigma0 + sum)/(n+v0)
print(s)
return(invChiSquare(vn, s))
}
currSigma <- drawSigma(currMu)
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
## plot mu and sigma
plot(mu, sqrt(sigma2),type='l')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
data <- read.table("rainfall.txt", col.names = x)
rawData <- data
x <- as.matrix(rawData['x'])
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
data <- read.table("rainfall.txt")
rawData <- data
x <- as.matrix(rawData[[1]])
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
plot(muRes)
plot(muRes, type='l')
plot(muRes[1], type='l')
plot(muRes[1,], type='l')
plot(muRes[2], type='l')
plot(muRes[,1], type='l')
plot(muRes[,2], type='l')
muRes
summary(muRes)
muRes[1]
muRes[2]
muRes[3]
muRes[1]
muRes[4]
muRes['0%]
''
muRes['0%']
muRes['0%',1]
muRes['0%'][1]
muRes['0%'][10]
muRes['0%'][2]
muRes['0%'][1]
muRes['0%']
?matrix
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/NormalMixtureGibbs.R')
plot(muRes[1])
plot(muRes[1,])
muRes
plot(muRes[,1])
plot(muRes[,1], type='l')
lines(muRes[,2])
plot(muRes[,1], type='l')
lines(muRes[,2])
plot(muRes[,1], type='l')
lines(muRes[,2], col='red')
plot(muRes[,2], type='l')
lines(muRes[,2], col='red')
plot(muRes[,1], type='l')
plot(muRes[,1], type='l', ylim = c(0,70))
lines(muRes[,2], col='red')
plot(sigmaRes[,1], type='l', ylim = c(0,70))
lines(sigmaRes[,2], col='red')
plot(sigmaRes[,1], type='l')
lines(sigmaRes[,2], col='red')
plot(sqrt(sigmaRes[,1]), type='l')
lines(sqrt(sigmaRes[,2]), col='red')
plot(sqrt(sigmaRes[,1]), type='l', ylim = c(0,55))
lines(sqrt(sigmaRes[,2]), col='red')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
source('~/Documents/Liu/År 4/TDDE07/labs/tdde07/Lab3/Lab3_1.R')
ndens <- dnorm(seq(0,100,by(100/n)), mean(mu), mean(sqrt(sigma2)))
ndens <- dnorm(seq(0,100,by=(100/n)), mean(mu), mean(sqrt(sigma2)))
hist(data$x)
lines(ndens)
lines(ndens)
plot(ndens)
ndens
?plot
plot(ndens, type='l', col='blue')
legend(legend = '2)')
legend('topright', legend = '2)')
legend('topright', legend = '2)', fill = 'blue')
hist(data)
hist(data$x)
plot(ndens, type='l', col='blue')
legend('topright', legend = '2)', fill = 'blue')
hist(data$x)
hist(data$x)
lines(ndens, col='blue')
legend('topright', legend = '2)', fill = 'blue')
hist(data$x, main = 'Plot 1c)', freq = FALSE)
lines(ndens, col='blue')
legend('topright', legend = '2)', fill = 'blue')
hist(data$x, main = 'Plot 1c)', freq = FALSE, xlim = c(0,1000))
lines(ndens, col='blue')
lines(ndens, col='blue')
hist(data$x, main = 'Plot 1c)', freq = FALSE)
lines(ndens, col='blue')
legend('topright', legend = '2)', fill = 'blue')
########## C #########
xGrid <- seq(0,100,by=(100/n))
ndens <- dnorm(xGrid, mean(mu), mean(sqrt(sigma2)))
hist(xGrid, data$x, main = 'Plot 1c)', freq = FALSE)
?hist
hist(data$x, 20, main = 'Plot 1c)', freq = FALSE)
lines(xGrid, ndens, col='blue')
########## C #########
xGrid <- seq(0,400,by=(100/n))
ndens <- dnorm(xGrid, mean(mu), mean(sqrt(sigma2)))
hist(data$x, 20, main = 'Plot 1c)', freq = FALSE)
lines(xGrid, ndens, col='blue')
lines(xGrid, mixDensMean, col = 'green')
lines(mixDensMean, col = 'green')
hist(data$x, 20, main = 'Plot 1c)', freq = FALSE)
lines(xGrid, ndens, col='blue')
lines(mixDensMean, col = 'green')
legend('topright', legend = c('2)', '3)'), fill = c('blue', 'green')
legend('topright', legend = c('2)', '3)'), fill = c('blue', 'green'))
legend("topright", legend = c("2)", "3)"), fill = c("blue", "green"))
legend("topright", legend = c("Data", "2)", "3)"), fill = c("white", "blue", "green"))
data <- read.table("eBayNumberOfBidderData.txt", header = TRUE)
data <- read.table("eBayNumberOfBidderData.txt", header = TRUE)
fit <- glm(nBids ~ LogBook, data, family = poisson)
View(fit)
fit <- glm(nBids ~ Constant + LogBook, data, family = poisson)
View(fit)
View(fit)
fit <- glm(nBids ~ Constant + LogBook, data, family = poisson)
fit <- glm(nBids ~ Const + LogBook, data, family = poisson)
View(fit)
fit <- glm(nBids ~ Const + LogBook + PowerSeller, data, family = poisson)
fit <- glm(nBids ~ 0 + ., data, family = poisson)
View(fit)
View(data)
View(data)
View(fit)
data <- read.table("eBayNumberOfBidderData.txt", header = TRUE)
########## A ##########
fit <- glm(nBids ~ 0 + ., data, family = poisson)
View(fit)
data <- read.table("eBayNumberOfBidderData.txt", header = TRUE)
########## A ##########
fit <- glm(nBids ~ 0 + ., data, family = poisson)
View(fit)
coeff <- fit$coefficients
hist(coeff)
plot(coeff, type='h')
plot(coeff, type='h', lw=4)
plot(coeff, type='h', lw=4)
plot(coeff, type='h', lw=2)
plot(coeff, type='h', lwd=2)
plot(coeff, type='h', lwd=2, xlab = "coefficient index")
plot(abs(coeff), type='h', lwd=2, xlab = "coefficient index")
View(data)
